(self.webpackChunk_0049_app=self.webpackChunk_0049_app||[]).push([[886],{69291:function(e,n,t){"use strict";t.d(n,{A8:function(){return u},Bi:function(){return Z},CK:function(){return c},D0:function(){return o},F6:function(){return v},FI:function(){return j},Fs:function(){return i},IX:function(){return a},KG:function(){return x},Mn:function(){return l},NY:function(){return d},ZS:function(){return h},dV:function(){return s},fZ:function(){return f},gw:function(){return p},vr:function(){return m}});var r=t(48845);function i(e){return(0,r.v_)("api/v1/console/instance",e)}function a(){return(0,r.U2)("api/v1/console/instance/list")}function s(e){return(0,r.v_)("api/v1/console/instance/operate",e)}function o(e){return(0,r.IV)("api/v1/console/instance",e)}function l(e){return(0,r.v_)("api/v1/console/template",e)}function u(){return(0,r.U2)("api/v1/console/template/list")}function c(e){return(0,r.IV)("api/v1/console/template",e)}function d(e){return(0,r.v_)("api/v1/console/model",e)}function f(){return(0,r.U2)("api/v1/console/model/list")}function p(e){return(0,r.IV)("api/v1/console/model",e)}function m(e){return(0,r.v_)("api/v1/console/task",e)}function h(){return(0,r.U2)("api/v1/console/task/list")}function v(e){return(0,r.IV)("api/v1/console/task",e)}function Z(e){return(0,r.v_)("api/v1/console/image",e)}function x(){return(0,r.U2)("api/v1/console/image/list")}function j(e){return(0,r.U2)("api/v1/console/image/info",e)}},19920:function(e,n,t){"use strict";t.d(n,{S:function(){return i},h:function(){return a}});var r=t(48845);function i(e){return(0,r.U2)("api/v1/file/download",e)}function a(e){return(0,r.U2)("api/v1/file/info",e)}},69762:function(e){e.exports={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BASE_URL_DEV:"localhost",REACT_APP_BASE_URL_PRO:"47.243.60.114"}},70188:function(e,n,t){"use strict";t.d(n,{_:function(){return i}});var r=t(69762),i="production"===r.NODE_ENV?r.REACT_APP_BASE_URL_PRO:r.REACT_APP_BASE_URL_DEV},48845:function(e,n,t){"use strict";t.d(n,{IV:function(){return u},U2:function(){return o},v_:function(){return l}});var r=t(31243),i=t(70188),a=t(42434),s=r.Z.create({baseURL:"http://".concat(i._,":3000"),timeout:3e4});function o(e,n){return s.get(e,{params:n})}function l(e,n){return s.post(e,n)}function u(e,n){return s.delete(e,{params:n})}s.interceptors.request.use((function(e){var n,t;return e.headers.token=null!==(n=null===(t=a.ls.get("user"))||void 0===t?void 0:t.token)&&void 0!==n?n:"",e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return 10001===e.data.code?(a.ls.get("user")&&a.ls.remove("user"),void window.location.replace("/login")):e.data}),(function(e){return Promise.reject(e)}))},43040:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return P}});var r=t(74165),i=t(15861),a=t(29439),s=t(72791),o=t(77027),l=t(87309),u=t(66106),c=t(30914),d=t(3859),f=t(59029),p=t(11188),m=t(69291),h=t(19920),v=t(1413),Z=t(93433),x=t(90098),j=t(17828),g=t(376),_=t(29736),b=t(20696),y=t(70188),k=t(72351),w=t(80184);function C(e){var n=e.data,t=e.open,u=e.isEdit,c=e.onClose,d=e.refreshList,f=(0,s.useState)([]),p=(0,a.Z)(f,2),h=p[0],C=p[1],P=(0,s.useState)(!1),S=(0,a.Z)(P,2),E=S[0],I=S[1],L=x.Z.useForm(),T=(0,a.Z)(L,1)[0],U=o.ZP.useMessage(),F=(0,a.Z)(U,2),R=F[0],A=F[1];(0,s.useEffect)((function(){var e;I(null!==(e=n.is_github)&&void 0!==e&&e)}));var V={action:"http://".concat(y._,":3000/api/v1/file/upload?type=model"),onChange:function(e){"done"===e.file.status?R.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&R.error("".concat(e.file.name," file upload failed."));var n=(0,Z.Z)(e.fileList);n=n.map((function(e){return e.response&&(e.url=e.response.url),e})),C(n)}},M=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=(0,v.Z)((0,v.Z)({},T.getFieldsValue()),{},{is_github:E})).model_file_names=(null===(n=t.model_file)||void 0===n?void 0:n.map((function(e){return e.name})))||[],delete t.model_file,e.next=5,(0,m.NY)(t);case 5:0===(i=e.sent).code?R.success("model created successfully"):R.error(i.msg),d(),c();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,w.jsxs)(w.Fragment,{children:[A,(0,w.jsx)(j.Z,{title:u?"Edit Model":"Create Model",placement:"right",onClose:c,open:t,children:(0,w.jsxs)(x.Z,{name:"basic",style:{maxWidth:"85%"},labelCol:{span:8},wrapperCol:{span:16},initialValues:(0,v.Z)({},n),form:T,onFinish:M,onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,w.jsx)(x.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input name"}],children:(0,w.jsx)(g.Z,{})}),(0,w.jsx)(x.Z.Item,{label:"Model File",name:"model_file",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null===e||void 0===e?void 0:e.fileList},children:(0,w.jsx)(_.Z,(0,v.Z)((0,v.Z)({},V),{},{children:(null===h||void 0===h?void 0:h.length)<1&&(0,w.jsx)(l.ZP,{icon:(0,w.jsx)(k.Z,{}),children:"Click to Upload"})}))}),(0,w.jsx)(x.Z.Item,{label:"Github",children:(0,w.jsx)(b.Z,{onChange:I,checked:E})}),E&&(0,w.jsx)(x.Z.Item,{label:"Github Link",name:"github_link",rules:[{required:!0,message:"Please input github link"}],children:(0,w.jsx)(g.Z,{})}),(0,w.jsx)(x.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,w.jsx)(l.ZP,{type:"primary",htmlType:"submit",children:u?"Update":"Submit"})})]})})]})}function P(){var e=(0,p.$)().t,n=o.ZP.useMessage(),t=(0,a.Z)(n,2),v=t[0],Z=t[1],x=(0,s.useState)(!1),j=(0,a.Z)(x,2),g=j[0],_=j[1],b=(0,s.useState)({}),y=(0,a.Z)(b,2),k=y[0],P=y[1],S=(0,s.useState)(!1),E=(0,a.Z)(S,2),I=E[0],L=E[1],T=(0,f.QT)((0,i.Z)((0,r.Z)().mark((function e(){var n,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.fZ)();case 2:return t=e.sent,e.abrupt("return",null===(n=t.data)||void 0===n?void 0:n.list);case 4:case"end":return e.stop()}}),e)})))),U=T.data,F=T.refresh,R=[{title:e("Name"),dataIndex:"name",key:"name"},{title:e("Model Flie"),dataIndex:"model_file_name",key:"model_file_name",render:function(e,n){return e&&!n.is_default?(0,w.jsx)("div",{children:(0,w.jsx)(l.ZP,{type:"link",onClick:(0,i.Z)((0,r.Z)().mark((function e(){var t,i,a,s,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.model_file_name,i=n.model_file_path,e.next=3,(0,h.S)({file_name:t,file_path:i});case 3:-1===(a=e.sent).code?v.error(a.msg):(s=new Blob([a],{type:"application/octet-stream"}),(o=document.createElement("a")).download=t,o.href=URL.createObjectURL(s),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o));case 5:case"end":return e.stop()}}),e)}))),children:e})}):"-"}},{title:e("Github Link"),dataIndex:"github_link",key:"github_link",render:function(e){return e||"-"}},{title:e("Action"),render:function(n,t){return(0,w.jsxs)("div",{children:[(0,w.jsx)(l.ZP,{type:"link",onClick:function(){P(t),_(!0),L(!0)},disabled:t.is_default,children:e("Edit")}),(0,w.jsx)(l.ZP,{type:"text",danger:!0,onClick:(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.gw)({id:n.id});case 2:0===(t=e.sent).code?(v.success(t.msg),F()):v.error(t.msg);case 4:case"end":return e.stop()}}),e)}))),disabled:t.is_default,children:e("Remove")})]})}}];return(0,w.jsxs)("div",{children:[Z,(0,w.jsx)(u.Z,{style:{marginBottom:"10px"},children:(0,w.jsx)(c.Z,{span:2,children:(0,w.jsx)(l.ZP,{type:"primary",style:{margin:"0 10px"},onClick:function(){L(!1),_(!0)},children:"New Model"})})}),(0,w.jsx)(d.Z,{columns:R,dataSource:U,pagination:{defaultPageSize:5},rowKey:"id"}),(0,w.jsx)(C,{data:k,open:g,isEdit:I,refreshList:F,onClose:function(){P({}),_(!1)}})]})}},78373:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return L}});var r=t(74165),i=t(15861),a=t(29439),s=t(72791),o=t(77027),l=t(82339),u=t(16726),c=t(87309),d=t(66106),f=t(30914),p=t(3859),m=t(59029),h=t(11188),v=t(69291),Z=t(1413),x=t(93433),j=t(90098),g=t(29736),_=t(17828),b=t(376),y=t(9555),k=t(77128),w=t(67174),C=t(72351),P=t(70188),S=t(19920),E=t(80184);function I(e){var n=e.data,t=e.open,d=e.isEdit,f=e.onClose,p=e.refreshList,h=n.name,I=n.model,L=n.status,T=n.created_at,U=n.type,F=n.data_file_name,R=n.data_file_path,A=(0,s.useState)(),V=(0,a.Z)(A,2),M=V[0],D=V[1],N=(0,s.useState)([]),O=(0,a.Z)(N,2),B=O[0],q=O[1],z=(0,s.useState)(""),K=(0,a.Z)(z,2),G=K[0],H=K[1],Q=(0,s.useState)([]),W=(0,a.Z)(Q,2),Y=W[0],$=W[1],X=j.Z.useForm(),J=(0,a.Z)(X,1)[0],ee=o.ZP.useMessage(),ne=(0,a.Z)(ee,2),te=ne[0],re=ne[1],ie=(0,m.QT)(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.A8)();case 2:return i=e.sent,e.abrupt("return",(null===(t=i.data)||void 0===t?void 0:t.list)||[]);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),ae=ie.data,se=(0,m.QT)((0,i.Z)((0,r.Z)().mark((function e(){var n,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.fZ)();case 2:return t=e.sent,e.abrupt("return",(null===(n=t.data)||void 0===n?void 0:n.list)||[]);case 4:case"end":return e.stop()}}),e)})))).data,oe=(0,m.QT)(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.h)({file_path:n});case 2:return t=e.sent,e.abrupt("return",t.data||[]);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),{manual:!0}),le=oe.run;(0,s.useEffect)((function(){(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(G);case 2:n=e.sent,q(n||[]);case 4:case"end":return e.stop()}}),e)})))()}),[G]);var ue={action:"http://".concat(P._,":3000/api/v1/file/upload?type=data"),headers:{authorization:"authorization-text"},beforeUpload:function(e){var n="text/csv"===e.type;return n||te.error("".concat(e.name," is not a text file")),n||g.Z.LIST_IGNORE},onChange:function(e){"done"===e.file.status?te.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&te.error("".concat(e.file.name," file upload failed."));var n=(0,x.Z)(e.fileList);n=n.map((function(e){var n,t;e.response&&(H(null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.file_path),e.url=e.response.url);return e})),$(n)}},ce=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=J.getFieldsValue()).data_file_names=(null===(n=t.data_file)||void 0===n?void 0:n.map((function(e){return e.name})))||[],delete t.data_file,e.next=5,(0,v.vr)(t);case 5:0===(i=e.sent).code?(te.success("task created successfully"),p(),f()):te.error(i.msg);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,E.jsxs)(E.Fragment,{children:[re,(0,E.jsx)(_.Z,{title:d?"Create Task":"Task Detail",placement:"right",onClose:f,open:t,children:d?(0,E.jsxs)(j.Z,{name:"basic",style:{maxWidth:"85%"},labelCol:{span:8},wrapperCol:{span:16},initialValues:(0,Z.Z)({},n),form:J,onFinish:ce,onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,E.jsx)(j.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input name"}],children:(0,E.jsx)(b.Z,{})}),(0,E.jsx)(j.Z.Item,{label:"Type",name:"type",rules:[{required:!0,message:"Please choose task type"}],children:(0,E.jsx)(y.Z,{style:{width:190},options:[{value:"training",label:"Training Task"},{value:"deployment",label:"Deployment Task"}],onChange:D})}),"training"===M&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(k.Z,{orientation:"left",orientationMargin:"0",plain:!0,children:"Training Attributes"}),(0,E.jsx)(j.Z.Item,{label:"Model",name:"model",rules:[{required:!0,message:"Please choose a model"}],children:(0,E.jsx)(y.Z,{options:se.map((function(e){return{value:e.name,label:e.name}}))})}),(0,E.jsx)(j.Z.Item,{label:"Data File",name:"data_file",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null===e||void 0===e?void 0:e.fileList},children:(0,E.jsx)(g.Z,(0,Z.Z)((0,Z.Z)({},ue),{},{children:(null===Y||void 0===Y?void 0:Y.length)<1&&(0,E.jsx)(c.ZP,{icon:(0,E.jsx)(C.Z,{}),children:"Click to Upload"})}))}),Y.length>0&&(0,E.jsx)(j.Z.Item,{label:"Label",name:"training_label",rules:[{required:!0,message:"Please input training label"}],children:(0,E.jsx)(y.Z,{style:{width:190},options:null===B||void 0===B?void 0:B.map((function(e){return{value:e,label:e}}))})})]}),"deployment"===M&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(k.Z,{orientation:"left",orientationMargin:"0",plain:!0,children:"Deployment Attributes"}),(0,E.jsx)(j.Z.Item,{label:"Template",name:"template",rules:[{required:!0,message:"Please choose a template"}],children:(0,E.jsx)(y.Z,{options:ae.map((function(e){return{value:e.name,label:e.name}}))})})]}),(0,E.jsx)(j.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,E.jsx)(c.ZP,{type:"primary",htmlType:"submit",children:d?"Update":"Submit"})})]}):(0,E.jsxs)(w.Z,{title:h,column:1,children:[(0,E.jsx)(w.Z.Item,{label:"Type:",children:(0,E.jsx)(l.Z,{color:"training"===U?"green":"blue",children:U})}),(0,E.jsx)(w.Z.Item,{label:"Status",children:"running"===L?(0,E.jsxs)("div",{children:[(0,E.jsx)(u.Z,{status:"success"})," ",(0,E.jsx)("span",{children:L})," "]}):(0,E.jsxs)("div",{children:[(0,E.jsx)(u.Z,{status:"error"})," ",(0,E.jsx)("span",{children:L})]})}),(0,E.jsx)(w.Z.Item,{label:"Model:",children:I}),(0,E.jsx)(w.Z.Item,{label:"Created At",children:new Date(T).toString()}),(0,E.jsx)(w.Z.Item,{label:"Data File",children:(0,E.jsx)(c.ZP,{type:"link",size:"small",onClick:(0,i.Z)((0,r.Z)().mark((function e(){var n,t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.S)({file_name:F,file_path:R});case 2:-1===(n=e.sent).code?te.error(n.msg):(t=new Blob([n],{type:"application/octet-stream"}),(i=document.createElement("a")).download=F,i.href=URL.createObjectURL(t),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i));case 4:case"end":return e.stop()}}),e)}))),children:F})})]})})]})}function L(){var e=(0,h.$)().t,n=o.ZP.useMessage(),t=(0,a.Z)(n,2),Z=t[0],x=t[1],j=(0,s.useState)(!1),g=(0,a.Z)(j,2),_=g[0],b=g[1],y=(0,s.useState)({}),k=(0,a.Z)(y,2),w=k[0],C=k[1],P=(0,s.useState)(!1),S=(0,a.Z)(P,2),L=S[0],T=S[1],U=(0,m.QT)((0,i.Z)((0,r.Z)().mark((function e(){var n,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.ZS)();case 2:return t=e.sent,e.abrupt("return",(null===(n=t.data)||void 0===n?void 0:n.list)||[]);case 4:case"end":return e.stop()}}),e)})))),F=U.data,R=U.refresh,A=[{title:e("Name"),dataIndex:"name",key:"name"},{title:e("Type"),dataIndex:"type",key:"type",render:function(e){return(0,E.jsx)(l.Z,{color:"training"===e?"green":"blue",children:e})}},{title:e("Status"),dataIndex:"status",key:"status",render:function(e){return"running"===e?(0,E.jsxs)("div",{children:[(0,E.jsx)(u.Z,{status:"success"})," ",(0,E.jsx)("span",{children:e})]}):(0,E.jsxs)("div",{children:[(0,E.jsx)(u.Z,{status:"error"})," ",(0,E.jsx)("span",{children:e})]})}},{title:e("Action"),render:function(n,t){return(0,E.jsxs)("div",{children:[(0,E.jsx)(c.ZP,{type:"link",onClick:function(){C(t),b(!0),T(!1)},children:e("Detail")}),(0,E.jsx)(c.ZP,{type:"text",danger:!0,onClick:(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.F6)({id:n.id});case 2:0===(t=e.sent).code?(Z.success(t.msg),R()):Z.error(t.msg);case 4:case"end":return e.stop()}}),e)}))),disabled:t.is_default,children:e("Remove")})]})}}];return(0,E.jsxs)("div",{children:[x,(0,E.jsx)(d.Z,{style:{marginBottom:"10px"},children:(0,E.jsx)(f.Z,{span:2,children:(0,E.jsx)(c.ZP,{type:"primary",style:{margin:"0 10px"},onClick:function(){T(!0),b(!0)},children:"New Task"})})}),(0,E.jsx)(p.Z,{columns:A,dataSource:F,pagination:{defaultPageSize:5},rowKey:"id"}),(0,E.jsx)(I,{data:w,open:_,isEdit:L,refreshList:R,onClose:function(){C({}),b(!1)}})]})}},72351:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(87462),i=t(72791),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},s=t(44279),o=function(e,n){return i.createElement(s.Z,(0,r.Z)({},e,{ref:n,icon:a}))};var l=i.forwardRef(o)},24654:function(){}}]);
//# sourceMappingURL=model.c9f3ec23.chunk.js.map