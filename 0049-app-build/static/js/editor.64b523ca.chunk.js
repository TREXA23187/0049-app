(self.webpackChunk_0049_app=self.webpackChunk_0049_app||[]).push([[189],{69291:function(e,t,n){"use strict";n.d(t,{A8:function(){return c},Bi:function(){return m},CK:function(){return s},D0:function(){return l},F6:function(){return x},FI:function(){return b},Fs:function(){return r},IX:function(){return i},KG:function(){return g},Mn:function(){return u},NY:function(){return d},ZS:function(){return v},dV:function(){return a},fZ:function(){return p},gw:function(){return f},vr:function(){return h}});var o=n(48845);function r(e){return(0,o.v_)("api/v1/console/instance",e)}function i(){return(0,o.U2)("api/v1/console/instance/list")}function a(e){return(0,o.v_)("api/v1/console/instance/operate",e)}function l(e){return(0,o.IV)("api/v1/console/instance",e)}function u(e){return(0,o.v_)("api/v1/console/template",e)}function c(){return(0,o.U2)("api/v1/console/template/list")}function s(e){return(0,o.IV)("api/v1/console/template",e)}function d(e){return(0,o.v_)("api/v1/console/model",e)}function p(){return(0,o.U2)("api/v1/console/model/list")}function f(e){return(0,o.IV)("api/v1/console/model",e)}function h(e){return(0,o.v_)("api/v1/console/task",e)}function v(){return(0,o.U2)("api/v1/console/task/list")}function x(e){return(0,o.IV)("api/v1/console/task",e)}function m(e){return(0,o.v_)("api/v1/console/image",e)}function g(){return(0,o.U2)("api/v1/console/image/list")}function b(e){return(0,o.U2)("api/v1/console/image/info",e)}},69762:function(e){e.exports={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BASE_URL_DEV:"localhost",REACT_APP_BASE_URL_PRO:"47.243.60.114"}},70188:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});var o=n(69762),r="production"===o.NODE_ENV?o.REACT_APP_BASE_URL_PRO:o.REACT_APP_BASE_URL_DEV},48845:function(e,t,n){"use strict";n.d(t,{IV:function(){return c},U2:function(){return l},v_:function(){return u}});var o=n(31243),r=n(70188),i=n(42434),a=o.Z.create({baseURL:"http://".concat(r._,":3000"),timeout:3e4});function l(e,t){return a.get(e,{params:t})}function u(e,t){return a.post(e,t)}function c(e,t){return a.delete(e,{params:t})}a.interceptors.request.use((function(e){var t,n;return e.headers.token=null!==(t=null===(n=i.ls.get("user"))||void 0===n?void 0:n.token)&&void 0!==t?t:"",e}),(function(e){return Promise.reject(e)})),a.interceptors.response.use((function(e){return 10001===e.data.code?(i.ls.get("user")&&i.ls.remove("user"),void window.location.replace("/login")):e.data}),(function(e){return Promise.reject(e)}))},30716:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return he}});var o=n(29439),r=n(72791),i=n(64880),a=n(74165),l=n(15861),u=n(1413),c=n(25671),s=n(70737),d=n(77027),p=n(87309),f=n(95058),h=n(60732),v=n(23414),x=n(19416),m=n(30144),g=n(24215),b=n(62444),Z=n(53834),y=n(65323),k=n(12056),j=n(31752),w=n(81694),S=n.n(w),_=n(42659),C=n.n(_),E=n(80184);function D(e){var t=(0,r.useRef)(),n=e.block,o=e.isPreview,i=e.updateBlock,c=e.onMouseDown,s=e.onContextMenu,d=e.globalData,p=e.updateGlobalData,f={top:"".concat(n.top,"px"),left:"".concat(n.left,"px"),zIndex:n.zIndex};(0,r.useEffect)((function(){var e=t.current,o=e.offsetWidth,r=e.offsetHeight,a=n;n.alignCenter&&(a=(0,u.Z)((0,u.Z)({},n),{},{left:n.left-o/2,top:n.top-r/2,alignCenter:!1})),a=(0,u.Z)((0,u.Z)({},a),{},{width:o,height:r}),i(a)}),[]);var h=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(t){var n,o,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.url){e.next=5;break}return e.next=4,new Promise((function(e){var n=new FileReader;n.readAsDataURL(t.originFileObj),n.onload=function(){return e(n.result)}}));case 4:n=e.sent;case 5:(o=new Image).src=n,null===(r=window.open(n))||void 0===r||r.document.write(o.outerHTML);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=e.config.componentMap[n.key],x=v.render({size:n.hasResize?{width:n.width,height:n.height}:{},props:n.props,model:Object.keys(v.model||{}).reduce((function(e,t){var o=n.model[t];return o&&(e[t]={value:d[o],onChange:function(e){var t;if("input"===n.key)t=e.target.value;else if("upload_image"===n.key){t=e.fileList}else t=e;var r=C()(d);r[o]=t,p(r)}},"upload_image"===n.key&&(e[t]=(0,u.Z)((0,u.Z)({},e[t]),{},{onPreview:h}))),e}),{})}),m=S()({"editor-block-focus":n.focus,"editor-block":!n.focus,"editor-block-preview":o}),g=v.resize||{};g.width,g.height;return(0,E.jsx)("div",{className:m,style:f,ref:t,onMouseDown:c,onContextMenu:s,children:x})}var L=n(93433),O=(0,n(10009).Z)();var I=n(69291),P=n(376),B=n(10140),M=n(83099),T=P.Z.TextArea;function z(e){var t=e.option,n=e.setOption,i=e.isModalOpen,a=e.handleOk,l=e.handleCancel,c=d.ZP.useMessage(),s=(0,o.Z)(c,2),f=(s[0],s[1]),h=(0,r.useState)(""),v=(0,o.Z)(h,2),x=v[0],m=v[1];return(0,E.jsxs)(B.Z,{title:t.title,open:i,footer:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(p.ZP,{onClick:l,danger:!0,children:"Cancel"}),(0,E.jsx)(p.ZP,{onClick:function(){t.callback?t.isExport?t.callback(x,t.content):t.callback(t.content):a()},type:"primary",children:"OK"})]}),onCancel:l,onOk:a,style:{position:"relative",minHeight:"400px"},children:[t.isExport&&(0,E.jsxs)(M.Z,{children:[(0,E.jsx)("span",{children:"title:"}),(0,E.jsx)(P.Z,{style:{width:"300px"},value:x,onChange:function(e){m(e.target.value)}})]}),(0,E.jsx)(T,{style:{minHeight:"250px",resize:"none",cursor:"text"},value:t.content,onChange:function(e){return n((0,u.Z)((0,u.Z)({},t),{},{content:e.target.value}))},disabled:t.isExport,bordered:!t.isExport}),f]})}function A(e){var t=e.item;return(0,E.jsxs)("div",{onClick:t.onClick,className:"menu-dropdown-item",children:[t.icon,(0,E.jsx)("span",{style:{marginLeft:"5px"},children:t.label}),t.keyboard&&(0,E.jsx)("span",{style:{position:"absolute",right:8,color:"#ccc"},children:t.keyboard})]})}function F(e){var t,n=e.option,o=e.isShow,i=e.setIsShow,a=e.menuDropdownStyle,l=e.menuDropdownRef,c=function(e){var t;null!==(t=l.current)&&void 0!==t&&t.contains(e.target)||i(!1)};return(0,r.useEffect)((function(){return document.body.addEventListener("mousedown",c,!0),function(){document.body.removeEventListener("mousedown",c)}}),[]),(0,E.jsx)("div",{style:(0,u.Z)({position:"absolute",display:o?"block":"none",zIndex:999},a),ref:l,className:"menu_dropdown",children:null===n||void 0===n||null===(t=n.content)||void 0===t?void 0:t.map((function(e){return(0,E.jsx)(A,{item:e},e.key)}))})}var N=n(90098),R=n(22441),V=n(55978),U=n(9555),J=n(82339),H=n(3859);function K(e){var t=e.config,n=e.data,i=e.isModalOpen,a=e.handleOk,l=e.handleCancel,u=(0,r.useState)(n.map((function(e,t){return e.key=t,e}))||[]),c=(0,o.Z)(u,2),s=c[0],d=c[1],f=[{title:"",dataIndex:"key",rowScope:"row"}],h=t.table.options.map((function(e,t){return{title:e.label,dataIndex:e.label,key:t,render:function(t,n){return(0,E.jsx)(P.Z,{value:n[e.label],onChange:function(t){var o=C()(s);o[n.key][e.label]=t.target.value,d(o)}})}}}));return(f=[].concat((0,L.Z)(f),(0,L.Z)(h))).push({title:"Action",key:"action",render:function(e,t){return(0,E.jsx)(M.Z,{size:"middle",children:(0,E.jsx)(p.ZP,{type:"text",danger:!0,onClick:function(){var e=C()(s);e.splice(t.key,1),d(e)},children:"Delete"})})}}),(0,E.jsxs)(B.Z,{title:t.label,open:i,footer:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(p.ZP,{onClick:function(){d(n||[]),l()},danger:!0,children:"Cancel"}),(0,E.jsx)(p.ZP,{onClick:function(){a(s)},type:"primary",children:"OK"})]}),onCancel:l,style:{position:"relative"},children:[(0,E.jsx)(M.Z,{style:{marginBottom:8},children:(0,E.jsx)(p.ZP,{onClick:function(){return d([].concat((0,L.Z)(s),[{key:s.length}]))},children:"Add"})}),(0,E.jsx)(H.Z,{columns:f,dataSource:s})]})}function W(e){var t=e.propConfig,n=e.value,i=e.updateValue,a=(0,r.useState)(!1),l=(0,o.Z)(a,2),u=l[0],c=l[1],s=(0,r.useState)(n||[]),d=(0,o.Z)(s,2),f=d[0],h=d[1];return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(K,{config:t,data:f,updateData:h,isModalOpen:u,handleOk:function(e){c(!1),h(e),i(e)},handleCancel:function(){c(!1)}}),(0,E.jsxs)("div",{children:[(!f||0===f.length)&&(0,E.jsx)(p.ZP,{onClick:function(){return c(!0)},children:"Add"}),(f||[]).map((function(e,n){return(0,E.jsx)(J.Z,{color:"processing",style:{cursor:"pointer"},onClick:function(){return c(!0)},children:e[t.table.key]},n)}))]})]})}var X=n(20696);function Y(e){e.propConfig;var t=e.value,n=e.updateValue;return(0,E.jsx)(X.Z,{checked:t,onChange:function(e){return n(e)}})}function G(e){var t=e.getLastSelectedBlock,n=e.data,i=e.config,a=e.lastSelectedIndex,l=e.editData,c=e.updateContainer,s=e.updateBlock,f=(0,r.useState)([]),h=(0,o.Z)(f,2),v=h[0],x=h[1],m=N.Z.useForm(),g=(0,o.Z)(m,1)[0],b=d.ZP.useMessage(),Z=(0,o.Z)(b,2),y=Z[0],k=Z[1],j={};return(0,r.useEffect)((function(){if(t()&&-1!==a){var e=t(),n=i.componentMap[null===e||void 0===e?void 0:e.key],r=[];if(n&&n.props){var u=Object.entries(n.props).map((function(e,t){var n=(0,o.Z)(e,2),r=n[0],i=n[1];return j["props_".concat(i.name)]=l.props[r],(0,E.jsx)(N.Z.Item,{label:i.label,name:"props_".concat(i.name),children:{input:function(){return(0,E.jsx)(P.Z,{})},inputNum:function(){return(0,E.jsx)(R.Z,{})},color:function(){return(0,E.jsx)(V.Z,{format:"hex"})},select:function(){return(0,E.jsx)(U.Z,{options:i.options.map((function(e){return{label:e.label,value:e.value}}))})},table:function(){return(0,E.jsx)(W,{propConfig:i,value:g.getFieldValue("props_".concat(i.name)),updateValue:function(e){return g.setFieldValue("props_".concat(i.name),e)}})},switch:function(){return(0,E.jsx)(Y,{value:g.getFieldValue("props_".concat(i.name))||!1,updateValue:function(e){g.setFieldValue("props_".concat(i.name),e)}})}}[i.type]()},i.name)}));r=[].concat((0,L.Z)(r),[u])}n&&n.model&&r.push(Object.entries(n.model).map((function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];return j[n]=l.model[n],(0,E.jsx)(N.Z.Item,{label:r,name:n,children:(0,E.jsx)(P.Z,{})},n)}))),x(r)}else j.container_width=null===l||void 0===l?void 0:l.width,j.container_height=null===l||void 0===l?void 0:l.height,x([(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(N.Z.Item,{label:"Container Width",name:"container_width",children:(0,E.jsx)(R.Z,{})}),(0,E.jsx)(N.Z.Item,{label:"Container Height",name:"container_height",children:(0,E.jsx)(R.Z,{})})]})]);g.setFieldsValue(j),j={}}),[a,t()]),(0,E.jsxs)("div",{children:[k,(0,E.jsxs)(N.Z,{name:"basic",style:{maxWidth:300},form:g,autoComplete:"off",children:[v.map((function(e,t){return(0,E.jsx)("div",{children:e},t)})),(0,E.jsxs)(N.Z.Item,{wrapperCol:{offset:4},children:[(0,E.jsx)(p.ZP,{type:"primary",onClick:function(){if(-1===a){var e=g.getFieldsValue(),t=e.container_width,r=e.container_height;c((0,u.Z)((0,u.Z)({},n),{},{container:(0,u.Z)((0,u.Z)({},n.container),{},{width:t,height:r})}))}else{var i={},d={};Object.entries(g.getFieldsValue()).forEach((function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];n.startsWith("props_")?i[n.replace("props_","")]=r:d[n]=r})),s((0,u.Z)((0,u.Z)({},l),{},{props:(0,u.Z)((0,u.Z)({},l.props),i),model:(0,u.Z)((0,u.Z)({},l.model),d)}),l)}y.open({type:"success",content:"Successfully applied!"})},children:"Apply"}),(0,E.jsx)(p.ZP,{style:{marginLeft:"10px"},onClick:function(){if(-1===a)j.container_width=null===l||void 0===l?void 0:l.width,j.container_height=null===l||void 0===l?void 0:l.height;else{var e=t(),n=i.componentMap[e.key];null!==n&&void 0!==n&&n.props&&Object.entries(n.props).forEach((function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];j[r.name]=l.props[n]}))}g.setFieldsValue(j),j={}},children:"Reset"})]})]})]})}function Q(){return(0,E.jsxs)("svg",{className:"grid",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",children:[(0,E.jsxs)("defs",{children:[(0,E.jsx)("pattern",{id:"smallGrid",width:"7.236328125",height:"7.236328125",patternUnits:"userSpaceOnUse",children:(0,E.jsx)("path",{d:"M 7.236328125 0 L 0 0 0 7.236328125",fill:"none",stroke:"rgba(207, 207, 207, 0.3)",strokeWidth:"1"})}),(0,E.jsxs)("pattern",{id:"grid",width:"36.181640625",height:"36.181640625",patternUnits:"userSpaceOnUse",children:[(0,E.jsx)("rect",{width:"36.181640625",height:"36.181640625",fill:"url(#smallGrid)"}),(0,E.jsx)("path",{d:"M 36.181640625 0 L 0 0 0 36.181640625",fill:"none",stroke:"rgba(186, 186, 186, 0.5)",strokeWidth:"1"})]})]}),(0,E.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})}var q=c.Z.Header,$=c.Z.Content,ee=c.Z.Sider;function te(e){var t=e.data,n=e.config,i=e.updateData,w=e.globalData,S=e.updateGlobalData,_=(0,r.useState)(!1),P=(0,o.Z)(_,2),B=P[0],M=P[1],T=(0,r.useState)({}),A=(0,o.Z)(T,2),N=A[0],R=A[1],V=(0,r.useState)(!1),U=(0,o.Z)(V,2),J=U[0],H=U[1],K=(0,r.useState)(!0),W=(0,o.Z)(K,2),X=W[0],Y=W[1],te=(0,r.useState)(!1),ne=(0,o.Z)(te,2),oe=ne[0],re=ne[1],ie=(0,r.useState)({top:0,left:0}),ae=(0,o.Z)(ie,2),le=ae[0],ue=ae[1],ce=(0,r.useState)({}),se=(0,o.Z)(ce,2),de=se[0],pe=se[1],fe=(0,r.useState)(-1),he=(0,o.Z)(fe,2),ve=he[0],xe=he[1],me=(0,r.useRef)(),ge=s.Z.useToken().token.colorBgContainer,be=d.ZP.useMessage(),Ze=(0,o.Z)(be,2),ye=Ze[0],ke=Ze[1],je={width:t.container.width+"px",height:t.container.height+"px"},we=function(e){var n=t.blocks;n[e.index]=e;var o=(0,u.Z)((0,u.Z)({},t),{},{blocks:n});i(o)},Se=(0,r.useRef)(),_e=function(e,t,n){var o=null,r=function(e){e.dataTransfer.dropEffect="move"},i=function(e){e.preventDefault()},a=function(e){e.dataTransfer.dropEffect="none"},l=function(e){var r=t.blocks,i=(0,u.Z)((0,u.Z)({},t),{},{blocks:[].concat((0,L.Z)(r),[{top:e.offsetY,left:e.offsetX,zIndex:1,key:o.key,alignCenter:!0,index:r.length,props:{},model:{}}])});n(i)};return{onDragStart:function(t,n){e.current.addEventListener("dragenter",r),e.current.addEventListener("dragover",i),e.current.addEventListener("dragleave",a),e.current.addEventListener("drop",l),o=n,O.emit("start")},onDragEnd:function(t){e.current.removeEventListener("dragenter",r),e.current.removeEventListener("dragover",i),e.current.removeEventListener("dragleave",a),e.current.removeEventListener("drop",l),O.emit("end")}}}(Se,t,i),Ce=_e.onDragStart,Ee=_e.onDragEnd,De=function(e,t,n,o,i){var a=o.updateData,l=o.updateBlock,c=o.setLastSelectedIndex,s=(0,r.useRef)(-1),d=function(){var t=[],n=[];return e.blocks.forEach((function(e){(e.focus?t:n).push(e)})),{focused:t,unfocused:n}},p=function(){var t=e.blocks.map((function(e){return e.focus=!1,e}));a((0,u.Z)((0,u.Z)({},e),{},{blocks:t}))};return{blockMouseDown:function(e,n){t||(e.preventDefault(),e.stopPropagation(),e.shiftKey?d().focused.length<=1?n.focus=!0:n.focus=!n.focus:n.focus||(p(),n.focus=!0),l(n),s.current=n.index,c(n.index),i(e))},containerMouseDown:function(e){var o;t||null!==(o=n.current)&&void 0!==o&&o.contains(e.target)||(p(),s.current=-1,c(-1))},getFocusData:d,getLastSelectedBlock:function(){return e.blocks[s.current]},clearBlockFocus:p}}(t,J,me,{updateData:i,updateBlock:we,setLastSelectedIndex:xe},(function(e){Te(e)})),Le=De.blockMouseDown,Oe=De.containerMouseDown,Ie=De.getFocusData,Pe=De.getLastSelectedBlock,Be=De.clearBlockFocus,Me=function(e,t,n,i){var a=i.updateBlock,l=(0,r.useState)({x:null,y:null}),c=(0,o.Z)(l,2),s=c[0],d=c[1],p={startX:0,startY:0,dragging:!1},f=function(t){var n=t.clientX,o=t.clientY;p.dragging||(p.dragging=!0,O.emit("start"));for(var r=n-p.startX+p.startLeft,i=o-p.startY+p.startTop,l=0;l<p.lines.y.length;l++){var c=p.lines.y[l],f=c.top,h=c.showTop,v=p.lines.x[l],x=v.left,m=v.showLeft;if(Math.abs(f-i)<5){Math.abs(x-r)<5?(d({x:m,y:h}),n=p.startX-p.startLeft+x):d((0,u.Z)((0,u.Z)({},s),{},{y:h})),o=p.startY-p.startTop+f;break}}for(var g=0;g<p.lines.x.length;g++){var b=p.lines.x[g],Z=b.left,y=b.showLeft,k=p.lines.y[g],j=k.top,w=k.showTop;if(Math.abs(Z-r)<5){Math.abs(j-i)<5?(d({y:w,x:y}),o=p.startY-p.startTop+j):d((0,u.Z)((0,u.Z)({},s),{},{x:y})),n=p.startX-p.startLeft+Z;break}}var S=n-p.startX,_=o-p.startY;e().focused.forEach((function(e,t){e.left=p.startPos[t].left+S,e.top=p.startPos[t].top+_,a(e)}))},h=function e(t){document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",e),d({x:null,y:null}),p.dragging&&O.emit("end")};return{mousedown:function(o){var r=t(),i=r.width,a=r.height;p={startX:o.clientX,startY:o.clientY,startLeft:t().left,startTop:t().top,dragging:!1,startPos:e().focused.map((function(e){return{top:e.top,left:e.left}})),lines:function(){var t=e().unfocused,o={x:[],y:[]};return[].concat((0,L.Z)(t),[{top:0,left:0,width:n.container.width,height:n.container.height}]).forEach((function(e){var t=e.top,n=e.left,r=e.width,l=e.height;o.y.push({showTop:t,top:t}),o.y.push({showTop:t,top:t-a}),o.y.push({showTop:t+l/2,top:t+l/2-a/2}),o.y.push({showTop:t+l,top:t+l}),o.y.push({showTop:t+l,top:t+l-a}),o.x.push({showLeft:n,left:n}),o.x.push({showLeft:n+r,left:n+r}),o.x.push({showLeft:n+r/2,left:n+r/2-i/2}),o.x.push({showLeft:n+r,left:n+r-i}),o.x.push({showLeft:n,left:n-i})})),o}()},document.addEventListener("mousemove",f),document.addEventListener("mouseup",h)},markLine:s}}(Ie,Pe,t,{updateBlock:we}),Te=Me.mousedown,ze=Me.markLine,Ae=function(e,t,n){var i=n.updateData,a=(0,r.useState)([]),l=(0,o.Z)(a,2),c=l[0],s=l[1],d=(0,r.useState)(-1),p=(0,o.Z)(d,2),f=p[0],h=p[1],v=(0,r.useState)(null),x=(0,o.Z)(v,2),m=x[0],g=x[1],b={commands:{},commandArray:[],destroyArray:[]},Z=function(e){b.commandArray.push(e),b.commands[e.name]=function(){var t=e.execute.apply(e,arguments),n=t.redo,o=t.undo;n(),e.pushQueue&&(c.length>0&&s(c.slice(0,f+1)),c.push({redo:n,undo:o}),h(f+1),s(c))}};return(0,r.useEffect)((function(){Z({name:"redo",keyboard:"ctrl+y",execute:function(){return{redo:function(){var e,t=c[f+1];t&&(null===(e=t.redo)||void 0===e||e.call(t),h(f+1))}}}}),Z({name:"undo",keyboard:"ctrl+z",execute:function(){return{redo:function(){if(-1!==f){var e,t=c[f];t&&(null===(e=t.undo)||void 0===e||e.call(t),h(f-1))}}}}}),Z({name:"drag",pushQueue:!0,init:function(){var t=function(){g(C()(e.blocks))},n=function(){b.commands.drag()};return O.on("start",t),O.on("end",n),function(){O.off("start",t),O.off("end",n)}},execute:function(){var t=e.blocks;return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:t}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:m}))}}}}),Z({name:"updateContainer",pushQueue:!0,execute:function(t){var n=C()(e),o=t;return{redo:function(){i(o)},undo:function(){i(n)}}}}),Z({name:"placeTop",pushQueue:!0,execute:function(){var n=C()(e.blocks);g(n);var o=function(){var e=t(),n=e.focused,o=e.unfocused,r=o.reduce((function(e,t){return Math.max(e,t.zIndex)}),-1/0);return n.forEach((function(e){return e.zIndex=r+1})),[].concat((0,L.Z)(n),(0,L.Z)(o))}();return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:o}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:n}))}}}}),Z({name:"placeBottom",pushQueue:!0,execute:function(){var n=C()(e.blocks);g(n);var o=function(){var e=t(),n=e.focused,o=e.unfocused,r=o.reduce((function(e,t){return Math.min(e,t.zIndex)}),1/0)-1;if(r<0){var i=Math.abs(r);r=0,o.forEach((function(e){return e.zIndex+=i}))}return n.forEach((function(e){return e.zIndex=r})),[].concat((0,L.Z)(n),(0,L.Z)(o))}();return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:o}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:n}))}}}}),Z({name:"copy",keyboard:"ctrl+c",pushQueue:!0,execute:function(){var n=C()(e.blocks);g(n);var o=function(){var n=t(),o=n.focused,r=(n.unfocused,[]);o.forEach((function(e){r.push(Object.assign({},e))}));for(var i=e.blocks.length,a=0;a<r.length;a++)r[a].index=i+a,r[a].top+=20,r[a].left+=20;return[].concat((0,L.Z)(e.blocks),r)}();return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:o}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:n}))}}}}),Z({name:"clear",pushQueue:!0,execute:function(){var t=C()(e.blocks);g(t);var n=[];return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:n}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:t}))}}}}),Z({name:"delete",pushQueue:!0,execute:function(){var n=C()(e.blocks);g(n);var o=t().unfocused;return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:o}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:n}))}}}}),Z({name:"updateBlock",pushQueue:!0,execute:function(t,n){var o=C()(e.blocks);g(o);var r=function(){var o=(0,L.Z)(e.blocks),r=o.indexOf(n);return r>-1&&o.splice(r,1,t),o}();return{redo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:r}))},undo:function(){i((0,u.Z)((0,u.Z)({},e),{},{blocks:o}))}}}});var n=function(){var e={67:"c",90:"z",89:"y"},t=function(t){var n=t.ctrlKey,o=t.metaKey,r=t.keyCode,i=[];(n||o)&&i.push("ctrl"),i.push(e[r]),i=i.join("+"),b.commandArray.forEach((function(e){var n=e.keyboard,o=e.name;n&&n===i&&(b.commands[o](),t.preventDefault())}))};return function(){return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}}();return b.destroyArray.push(n()),b.commandArray.forEach((function(e){e.init&&b.destroyArray.push(e.init())})),function(){b.destroyArray.forEach((function(e){return e&&e()}))}})),b}(t,Ie,{updateData:i}),Fe=Ae.commands,Ne=[{label:"Undo",icon:(0,E.jsx)(Z.Z,{}),handler:function(){Fe.undo()}},{label:"Redo",icon:(0,E.jsx)(Z.Z,{rotate:180}),handler:function(){return Fe.redo()}},{label:"Save",icon:(0,E.jsx)(y.Z,{}),handler:function(){R({title:"Export JSON",content:JSON.stringify(t),isExport:!0,callback:function(e,t){return(0,l.Z)((0,a.Z)().mark((function n(){var o;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,I.Mn)({name:e,content:t});case 2:0==(o=n.sent).code&&(ye.success(o.msg),M(!1));case 4:case"end":return n.stop()}}),n)})))()}}),M(!0)}},{label:"Import",icon:(0,E.jsx)(b.Z,{}),handler:function(){R({title:"Import JSON",content:"",footer:!0,isExport:!1}),M(!0)}},{label:"Top",icon:(0,E.jsx)(x.Z,{}),handler:function(){return Fe.placeTop()}},{label:"Bottom",icon:(0,E.jsx)(m.Z,{}),handler:function(){return Fe.placeBottom()}},{label:"Copy",icon:(0,E.jsx)(v.Z,{}),handler:function(){return Fe.copy()}},{label:"Delete",icon:(0,E.jsx)(h.Z,{}),handler:function(){return Fe.delete()}},{label:"Clear",icon:(0,E.jsx)(k.Z,{}),handler:function(){return Fe.clear()}},{label:function(){return J?"Edit":"Preview"},icon:function(){return J?(0,E.jsx)(j.Z,{}):(0,E.jsx)(g.Z,{})},handler:function(){H(!J),Be()}},{label:"Close",icon:(0,E.jsx)(h.Z,{}),handler:function(){H(!0),Y(!1),Be()}}],Re=[{key:"1",label:"Attribute",children:(0,E.jsxs)("div",{style:{padding:"10px"},children:[(0,E.jsx)("div",{className:"demo-logo-vertical"}),(0,E.jsx)(G,{getLastSelectedBlock:Pe,lastSelectedIndex:ve,data:t,config:n,editData:ve>-1?Pe():t.container,updateContainer:function(e){Fe.updateContainer(e)},updateBlock:function(e,t){Fe.updateBlock(e,t)},globalData:w,updateGlobalData:S})]})},{key:"2",label:"Event",children:"Content of Tab Event"}];return X?(0,E.jsxs)(c.Z,{style:{height:"86vh"},hasSider:!0,children:[(0,E.jsx)(ee,{theme:"light",width:"20%",children:(0,E.jsx)("div",{style:{overflow:"scroll",height:"95%"},children:n.componentList.map((function(e,t){return(0,E.jsxs)("div",{className:"editor-left-item",draggable:!0,onDragStart:function(t){Ce(t,e)},onDragEnd:Ee,children:[(0,E.jsx)("span",{children:e.label}),(0,E.jsx)("div",{children:e.preview(0)})]},t)}))})}),ke,(0,E.jsx)(z,{isModalOpen:B,setIsModalOpen:M,option:N,setOption:R,handleOk:function(){try{var e=JSON.parse(N.content);Fe.updateContainer(e),M(!1)}catch(t){ye.open({type:"error",content:"Invalid JSON"})}},handleCancel:function(){M(!1)}}),(0,E.jsxs)(c.Z,{children:[(0,E.jsx)(q,{style:{padding:0,background:ge},children:(0,E.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"4px"},children:Ne.map((function(e,t){var n="function"==typeof e.icon?e.icon():e.icon,o="function"==typeof e.label?e.label():e.label;return(0,E.jsxs)("div",{className:"editor-top-button",onClick:e.handler,children:[(0,E.jsx)("span",{style:{height:"20px"},children:n}),(0,E.jsx)("span",{children:o})]},t)}))})}),(0,E.jsx)($,{style:{margin:"20px 16px",position:"relative"},children:(0,E.jsxs)("div",{style:{background:ge},ref:Se,onMouseDown:Oe,children:[!J&&(0,E.jsx)(Q,{}),(0,E.jsx)("div",{style:(0,u.Z)({},je),children:t.blocks.map((function(e,t){return(0,E.jsx)(D,{block:e,config:n,isPreview:J,updateBlock:we,onMouseDown:function(t){return Le(t,e)},onContextMenu:function(t){return function(e,t){e.preventDefault(),re(!0),ue({top:t.top+t.height,left:t.left}),pe({content:[{label:"Delete",key:"delete",icon:(0,E.jsx)(h.Z,{}),onClick:function(){Fe.delete(),re(!1)}},{label:"Copy",key:"copy",icon:(0,E.jsx)(v.Z,{}),keyboard:"ctrl+c",onClick:function(){return Fe.copy()}},{label:"Top",key:"top",icon:(0,E.jsx)(x.Z,{}),onClick:function(){return Fe.placeTop()}},{label:"Bottom",key:"bottom",icon:(0,E.jsx)(m.Z,{}),onClick:function(){return Fe.placeBottom()}},{label:"Watch",key:"watch",icon:(0,E.jsx)(g.Z,{}),onClick:function(){R({title:"Element JSON",content:JSON.stringify(t),isExport:!0}),M(!0)}},{label:"Import",key:"import",icon:(0,E.jsx)(b.Z,{}),onClick:function(){R({title:"Import Element JSON",content:"",footer:!0,isExport:!1,callback:function(e){e=JSON.parse(e),Fe.updateBlock(e,t),M(!1)}}),M(!0)}}]})}(t,e)},globalData:w,updateGlobalData:S},t)}))}),(0,E.jsxs)("div",{children:[null!==ze.x&&(0,E.jsx)("div",{className:"line-x",style:{left:ze.x+"px"}}),null!==ze.y&&(0,E.jsx)("div",{className:"line-y",style:{top:ze.y+"px"}})]}),(0,E.jsx)(F,{option:de,isShow:oe,setIsShow:re,menuDropdownStyle:le,menuDropdownRef:me})]})})]}),(0,E.jsx)(ee,{theme:"light",width:"20%",children:(0,E.jsx)(f.Z,{defaultActiveKey:"1",items:Re,style:{padding:"20px"}})})]}):(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{style:(0,u.Z)((0,u.Z)({},je),{},{position:"relative"}),ref:Se,onMouseDown:Oe,children:t.blocks.map((function(e,t){return(0,E.jsx)(D,{block:e,config:n,isPreview:!0,updateBlock:we,onMouseDown:function(t){return Le(t,e)},globalData:w,updateGlobalData:S},t)}))}),(0,E.jsxs)("div",{style:{position:"absolute",right:10,top:10},children:[(0,E.jsx)(p.ZP,{type:"primary",onClick:function(){return Y(!0)},ghost:!0,children:"Back to Edit"}),(0,E.jsx)("div",{children:JSON.stringify(w)})]})]})}var ne=JSON.parse('{"container":{"width":800,"height":500},"blocks":[]}'),oe=n(29736),re=n(65273),ie=n(67174),ae=n(99514);var le,ue,ce=function(){var e=[],t={};return{componentList:e,componentMap:t,register:function(n){e.push(n),t[n.key]=n}}}(),se=function(e,t){return{type:"input",label:e,name:t}},de=function(e,t,n){return{type:"select",label:e,name:t,options:n}};ce.register({label:"text",preview:function(){return"text preview"},render:function(e){var t=e.props,n=t.color,o=n?"string"===typeof n?n:n.toHexString():"#000";return(0,E.jsx)("span",{style:{color:o,fontSize:t.size},children:t.text||"render text"})},key:"text",props:{text:se("content text","text"),color:(le="font color",ue="color",{type:"color",label:le,name:ue}),size:de("font size","size",[{label:"15px",value:"15px"},{label:"20px",value:"20px"},{label:"25px",value:"25px"}])}}),ce.register({label:"button",resize:{width:!0,height:!0},preview:function(){return(0,E.jsx)(p.ZP,{children:"button preview"})},render:function(e){var t=e.props,n=e.size;return(0,E.jsx)(p.ZP,{type:t.type,size:t.size,style:{width:n.width+"px",height:n.height+"px"},children:t.text||"render button"})},key:"button",props:{text:se("button text","text"),type:de("button type","type",[{label:"default",value:"default"},{label:"primary",value:"primary"},{label:"ghost",value:"ghost"},{label:"dashed",value:"dashed"},{label:"link",value:"link"},{label:"text",value:"text"}]),size:de("button size","size",[{label:"default",value:""},{label:"small",value:"small"},{label:"medium",value:"medium"},{label:"large",value:"large"}]),submit:function(e,t,n){return{type:"switch",label:e,name:t,isRadio:n}}("submit button","submit",!0)}}),ce.register({label:"input",resize:{width:!0},preview:function(){return(0,E.jsx)(P.Z,{placeholder:"input preview"})},render:function(e){var t=e.model,n=e.size;return(0,E.jsx)(P.Z,(0,u.Z)((0,u.Z)({placeholder:"render input"},null===t||void 0===t?void 0:t.default),{},{style:{width:n.width+"px"}}))},key:"input",model:{default:"Bound Field"}}),ce.register({label:"select",preview:function(){return(0,E.jsx)(U.Z,{style:{width:180},defaultValue:"select preview"})},render:function(e){var t=e.props,n=e.model;return(0,E.jsx)(U.Z,(0,u.Z)({style:{width:180},defaultValue:"render select",options:t.options||[]},null===n||void 0===n?void 0:n.default))},key:"select",props:{options:function(e,t,n){return{type:"table",label:e,name:t,table:n}}("options","options",{options:[{label:"label",field:"label"},{label:"value",field:"value"}],key:"label"})},model:{default:"Bound Field"}}),ce.register({label:"upload image",preview:function(){return(0,E.jsx)(oe.Z,{listType:"picture-card",children:"+ Upload"})},render:function(e){var t,n=e.props,o=e.model,r=n.max_image_num||1,i=(null===(t=o.default)||void 0===t?void 0:t.value)||[];return i=i.slice(0,r),(0,E.jsx)(ae.Z,{rotationSlider:!0,children:(0,E.jsx)(oe.Z,(0,u.Z)((0,u.Z)({action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",listType:"picture-card",maxCount:r,fileList:i,disabled:i.length>=r},null===o||void 0===o?void 0:o.default),{},{children:i.length<r&&"+ Upload"}))})},key:"upload_image",props:{max_image_num:function(e,t){return{type:"inputNum",label:e,name:t}}("max image num","max_image_num")},model:{default:"Bound Field"}});var pe=[{title:"Col_1",dataIndex:"col_1",key:"col_1"},{title:"Col_2",dataIndex:"col_2",key:"col_2"}],fe=[{key:"1",col_1:"content_1",col_2:"content_2"}];function he(){var e=new URLSearchParams((0,i.TH)().search),t=(0,r.useState)(JSON.parse(e.get("data"))||ne),n=(0,o.Z)(t,2),a=n[0],l=n[1],u=(0,r.useState)({test:"test"}),c=(0,o.Z)(u,2),s=c[0],d=c[1];return(0,E.jsx)("div",{style:{height:"75%"},children:(0,E.jsx)(te,{data:a,updateData:l,config:ce,globalData:s,updateGlobalData:d})})}ce.register({label:"table",preview:function(){return(0,E.jsx)(H.Z,{style:{width:"180px"},columns:pe,dataSource:fe,pagination:!1})},render:function(){return(0,E.jsx)(H.Z,{style:{width:"180px"},columns:pe,dataSource:fe,pagination:!1})},key:"table",model:{default:"Bound Field"}}),ce.register({label:"progress",preview:function(){return(0,E.jsx)(re.Z,{percent:30,style:{width:"180px"}})},render:function(){return(0,E.jsx)(re.Z,{percent:30,style:{width:"180px"}})},key:"progress",model:{default:"Bound Field"}}),ce.register({label:"description",preview:function(){return(0,E.jsx)(ie.Z,{title:"Description",children:(0,E.jsx)(ie.Z.Item,{label:"Label",children:"Value"})})},render:function(){return(0,E.jsx)(ie.Z,{title:"Description",size:"small",style:{width:"200px"},children:(0,E.jsx)(ie.Z.Item,{label:"Label",children:"Value"})})},key:"description"})}}]);
//# sourceMappingURL=editor.64b523ca.chunk.js.map